
<HTML>
    <head>
        <title>Chobocho's Simple Calculator</title>
            <style>
                .tile {
                  text-align:center;
                  width:40px;
                  height:40px;
                  font-size:24px;
                  background-color:"white";
                  border:1px solid black;
                  box-shadow:black 1px 1px;
                }
                
                textarea {
                  height:100px;
                  width:200px;
                  text-align:right;
                  font-size:24px;
                  border:1px solid black;
                  box-shadow:black 1px 1px;
                  padding:2px;
                }
            </style>       
        
        <script language="JavaScript">
            var sum = 0;
            var exp = "";
            var ret = "";
            
            function init() {
                var table = document.getElementById("keypad");

                
                window.onkeydown = onKeyDown;
                window.onkeyup   = onKeyUp;
                
                var keypadValue = [ "AC", "←", "(", ")", "7", "8", "9", "÷", "4", "5", "6", "×", "1", "2", "3", "-", "0", ".", "=", "+" ];                

                for (var i = 0; i < 5; i++) {
                    var tr = document.createElement("tr");
                    for (var j = 0; j < 4; j++) {
                        var td = document.createElement("td");
                        td.className="tile";
                        var idx = i*4 + j;
                     
                        td.value = idx;
                        td.index = idx;
                        td.textContent = keypadValue[idx];
                        td.onclick = onClick;
                        tr.appendChild(td);
                    }
                    table.appendChild(tr);
                } 
            }  
            function onKeyUp(e) {
            }
            function onKeyDown(e) {
            }
            function onClick(e) {
               var clkTile = e.srcElement.index;
               var isClickEqual = false;

               switch(clkTile) {
               case 0 : // AC
                    sum = 0;
                    ret = "";
                    exp = "";
                    break;
               case 1 : // <-
                    ret = ret.slice(0,-1);
                    break;
               case 2 : // (
                    ret = ret + "(";
                    break;
               case 3 : // )
                    ret = ret + ")";
                    break;
               case 4 : // 7
                    ret = ret + "7";
                    break;
               case 5 : // 8
                       ret = ret + "8";
                    break;
               case 6 : // 9
                    ret = ret + "9";
                    break;
               case 7 : // ÷
                    //exp = exp + ret + "/"; 
                    ret = ret + "/";
                    break;
               case 8 : // 4
                    ret = ret + "4";
                    break;
               case 9 :
                    ret = ret + "5";
                    break;
               case 10 :
                    ret = ret + "6";
                    break;
               case 11 : // x
                    exp = exp + ret + "*"; 
                    ret = ret + "*";
                    break;
               case 12 : 
                    ret = ret + "1";
                    break;
               case 13 :
                    ret = ret + "2";
                    break;
               case 14 :
                    ret = ret + "3";
                    break;
               case 15 : // -
                    if (ret == "") {
                        ret = "-";
                    } else {
                        exp = exp + ret + "-"; 
                        ret = ret + "-";
                    }
                    break;
               case 16 : 
                    ret = ret + "0";
                    break;
               case 17 : // .
                    if (ret == "") {
                        ret = "0.";
                    } else {
                        ret = ret + ".";
                    }
                    
                    break;
               case 18 : // =
                    try {
                        sum = eval(ret);
                    } catch(e) {
                        sum = "Error";
                    }
                    ret = "";
                    isClickEqual = true;
                    break;
               case 19 : // +
                    exp = exp + ret + "+"; 
                    ret = ret + "+";
                    break;               
               default:
                   break;
               }
               console.log("Ret " + ret + " Sum : " + sum);
               
               document.getElementById("result").value = isClickEqual ? sum : ret;
            }         
        </script>
    </head>
    <body onload="init()">
         <table id="keypad" align="center">
            <tr>
                <td colspan=4>
                <textarea id="result" disabled=true cols="35" rows="1"></textarea>
                </td>
            </tr>
         </table>
    </body>
</HTML>